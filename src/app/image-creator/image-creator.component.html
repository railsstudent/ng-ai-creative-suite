<div class="max-w-4xl mx-auto">
  <h1 class="text-3xl sm:text-4xl font-extrabold text-white mb-2">Image Creator</h1>
  <p class="text-lg text-gray-400 mb-6">Bring your ideas to life. Describe an image and watch AI create it.</p>

  <div class="bg-gray-800 rounded-lg shadow-xl p-6">
    <app-image-menu-bar
      [(prompt)]="prompt"
      [(numberOfImages)]="numberOfImages"
      [(aspectRatio)]="aspectRatio"
      [(enableVideoGeneration)]="enableVideoGeneration"
      [isGeneratingVideo]="videoPlayer()?.isGeneratingVideo() ?? false"
      [isGenerateVideoDisabled]="videoPlayer()?.isGenerateVideoDisabled() ?? true"
      (generateImage)="generateImage()"
      (generateVideo)="onGenerateVideo()"
    />
  </div>

  <app-prompt-history
    [history]="promptHistory()"
    (promptSelected)="prompt.set($event)"
    (historyCleared)="clearHistory()"
  />

  @if (error()) {
    <div class="mt-6 bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded-lg relative" role="alert">
      <strong class="font-bold">Error:</strong>
      <span class="block sm:inline ml-2">{{ error() }}</span>
    </div>
  }

  <div class="mt-6">
    @if (isLoading()) {
      <app-loader loadingText="Generating your images...">
        <p class="text-sm">This may take a moment.</p>
      </app-loader>
    } @else {
      <app-image-grid
        [images]="imageUrls()"
        [selectedImageId]="selectedImageId()"
        [enableSelection]="enableVideoGeneration()"
        (imageSelected)="selectImage($event)"
        (imageDownloaded)="downloadImage($event)"
        />
    }
  </div>

  @if (enableVideoGeneration()) {
    <app-video-player
      [prompt]="prompt()"
      [selectedImage]="selectedImage()"
      [isImageLoading]="isLoading()" />
  }

  <app-confirmation-dialog
    [isOpen]="showDownloadConfirmation()"
    confirmText="Download"
    (confirm)="confirmDownload()"
    (cancel)="cancelDownload()"
  >
    <h3 class="text-xl font-semibold text-white mb-2">Confirm Download</h3>
    <p class="text-gray-400 mb-6">Are you sure you want to download this image?</p>
  </app-confirmation-dialog>
</div>
